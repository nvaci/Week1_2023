install.packages('xaringan')
install.packages('devtools')
devtools::install_github("gadenbuie/xaringanExtra")
require(xaringan)
inf_mr()
inf_mr()
install.packages('xfun')
install.packages("xfun")
install.packages('xfun')
install.packages("xfun")
require(xaringan)
inf_mr()
set.seed(456)
Babies=data.frame(Age=round(runif(100,1,30)), Weight=rnorm(100,4000,500))
Babies$Height=rnorm(100,40+0.2*Babies$Age+0.004*Babies$Weight, 5)
Babies$Gender=factor(rbinom(100,1,0.5))
levels(Babies$Gender)=c('Girls','Boys')
lm2<-lm(Height~Age+Weight, data=Babies)
lm2$coefficients
lmA=lm(Age~Weight, data=Babies)
lmH=lm(Height~Weight, data=Babies)
AgeP=residuals(Age)
AgeP=residuals(lmA)
HeightP=residuals(lmH)
lm(HeightP~AgeP)
lm(HeightP~AgeP)$coeficients
lm(HeightP~AgeP)$coeficients
lm(HeightP~AgeP)$coefficients
AgeRes=residuals(lm(Age~Weight, data=Babies))
HeightRes=residuals(lm(Height~Weight, data=Babies))
anova(lm1)
inequality<-read.table('inequality.txt',sep=',', header=T)
knitr::kable(head(inequality[,c(1,2,8,12)]), format = 'html')
par(mfrow=c(1,2), bty='n',mar = c(5, 4, 1, .1), cex=1.1, pch=16)
plot(density(inequality$hate_crimes_per_100k_splc, na.rm = T), main='Crimes per 100k')
plot(density(inequality$avg_hatecrimes_per_100k_fbi, na.rm = T), main='Average Crimes')
par(mfrow=c(1,2), bty='n',mar = c(5, 4, 1, .1), cex=1.1, pch=16)
plot(density(inequality$median_household_income, na.rm = T), main='Income')
plot(density(inequality$gini_index, na.rm = T), main='Gini')
par(bty='n',mar = c(5, 4, .1, .1), cex=1.1, pch=16)
plot(inequality$median_household_income, inequality$avg_hatecrimes_per_100k_fbi, xlab='Median household income',ylab='Avg hatecrimes')
par(bty='n',mar = c(5, 4, .1, .1), cex=1.1, pch=16)
plot(inequality$gini_index, inequality$avg_hatecrimes_per_100k_fbi,xlab='Gini index',ylab='Avg hatecrimes')
cor(inequality[,c(2,8,12)], use="complete.obs")
?cor
names(inequality)
names(inequality)[c(2,8,12)]=c('Median_income','Gini','Avg_hate')
cor(inequality[,c(2,8,12)], use="complete.obs")
mod1<-lm(avg_hatecrimes_per_100k_fbi~median_household_income, data=inequality)
summary(mod1)
mod1<-lm(Avg_hate~Median_income, data=inequality)
summary(mod1)
mod2<-lm(Avg_hate~Median_income+Gini, data=inequality)
anova(mod2)
anova(mod1,mod2)
anova(mod2)
mod3<-lm(Avg_hate~Median_income*Gini, data=inequality)
anova(mod1,mod2, mod3)
anova(mod2, mod3)
summary(mod3)
require(interactions)
interact_plot(mod3, pred=median_household_income, modx=gini_index, plot.points = T)
interact_plot(mod3, pred=Median_income, modx=Gini, plot.points = T)
simulatedD<-data.frame(Median_income=rep(seq(35500, 76165, by=100), 13), Gini=rep(seq(0.41,0.53, by=.01), each=407))
simulatedD$pred<-predict(mod3, newdata=simulatedD)
p<-ggplot(simulatedD, aes(Median_income, Avg_hate_pred, color=Gini,frame=Gini))+geom_point()
require(ggplot2)
p<-ggplot(simulatedD, aes(Median_income, Avg_hate_pred, color=Gini,frame=Gini))+geom_point()
plotly::ggplotly(p)
simulatedD$Avg_hate_pred<-predict(mod3, newdata=simulatedD)
plotly::ggplotly(p)
p<-ggplot(simulatedD, aes(Median_income, Avg_hate_pred, color=Gini,frame=Gini))+geom_point()
plotly::ggplotly(p)
install.packages('performance')
require(performance)
check_model(mod3)
check_model(mod3)[1]
?check_model
check_model(mod3, panel=F)
check_model(mod3, panel=F)[1]
check_model(mod3, check='normality')
summary(mod3$residuals)
par(bty='n',mar = c(5, 4, .1, .1), cex=1.1, pch=16)
car::qqPlot(mod3)
check_model(mod3, check='normality')
check_model(mod3, check='qq')
par(bty='n',mar = c(5, 4, .1, .1), cex=1.1, pch=16)
check_model(mod3, check='qq')
mod3.cor<-lm(Avg_hate~Median_income*Gini, data=inequality, subset=-9)
summary(mod3.cor)
mod2.cor<-lm(Avg_hate~Median_income+Gini, data=inequality, subset=-9)
summary(mod2.cor)
check_model(mod3, check='qq')
check_model(mod3)
par(bty='n',mar = c(5, 4, .1, .1), cex=1.1, pch=16)
car:: residualPlot(mod3, type='rstudent')
par(bty='n',mar = c(5, 4, .1, .1), cex=1.1, pch=16)
car:: residualPlot(mod3, type='rstudent')
par(bty='n',mar = c(5, 4, .1, .1), cex=1.1, pch=16)
car:: influenceIndexPlot(mod3, vars=c("Cook","studentized"))
par(bty='n',mar = c(5, 4, .1, .1), cex=1.1, pch=16)
car:: influenceIndexPlot(mod3, vars=c("Bonf","hat"))
par(bty='n',mar = c(5, 4, .1, .1), cex=1.1, pch=16)
stats::acf(resid(mod3))
par(bty='n',mar = c(5, 4, .1, .1), cex=1.1, pch=16)
plot(predict(mod3),mod3$model$Avg_hate, xlab='Predicted values (model 3)', ylab='Observed values (avg hatecrimes)')
model_performance(mod3)
model_check(mod3)
check_model(mod3)
exp(-.64)
1/1-(exp(-.64))
exp(.11)
arm::invlogit(–1.02)
arm::invlogit(-1.02)
arm::invlogit(-1.02 –.64*1)
arm::invlogit(-1.02-.64*1)
arm::invlogit(-1.02-.64*2)
arm::invlogit(-1.02-.64*3)
skill[x] <- lm(NatTechZ  ~ PerStdZ  + unstrZ , data=paste('Data_nat_tech', '15', sep=''))
paste('Data_nat_tech', '15', sep='')
